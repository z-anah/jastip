<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ğŸ‡¹ğŸ‡³ Jastip</title>

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Vue 3 CDN -->
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
</head>

<body class="bg-gray-50 text-gray-800">
<div id="app" class="max-w-md mx-auto p-4">

  <!-- HEADER -->
  <header class="mb-4 flex justify-between items-center">
    <h1 class="text-lg font-semibold">ğŸ‡¹ğŸ‡³ Jastip</h1>
    <button @click="page='cart'" class="text-sm flex items-center gap-1">
      <img src="https://img.icons8.com/?size=64&id=y21Zo14Go4LV&format=png" alt="Cart" class="w-5 h-5">
      ({{ cart.length }})
    </button>
  </header>

  <!-- LIST PAGE -->
  <div v-if="page === 'list'">
    <div class="grid grid-cols-2 gap-3">
      <!-- Product cards -->
      <div v-for="p in products" :key="p.id">
        <template v-if="p.type === 'ad'">
          <!-- Ad card: full image, 320x320px -->
          <div class="bg-white rounded-lg overflow-hidden shadow-sm flex flex-col h-80 p-0">
            <img
              :src="p.image"
              class="w-full h-full object-cover"
              style="width:320px; height:320px;"
              alt="Ad"
            >
          </div>
        </template>
        <template v-else>
          <div class="bg-white rounded-lg overflow-hidden shadow-sm h-80 flex flex-col">
            <div class="relative w-full pt-[100%]">
              <img :src="p.image" class="absolute top-0 left-0 w-full h-full object-cover">
              <img
                src="https://img.icons8.com/?size=48&id=6KiDYP2M5aXT&format=png"
                alt="Hot"
                class="absolute bottom-4 right-2 w-6 h-6"
                style="z-index:2"
              >
            </div>
            <div class="p-3 flex-1">
              <p class="font-medium text-sm mb-1 line-clamp-2 h-10" :title="p.name">{{ p.name }}</p>
              <p class="text-xs text-gray-500 mb-2">Rp{{ p.price.toLocaleString() }}</p>
              <div class="flex items-center justify-between gap-2">
                <button
                  class="text-xs text-blue-500"
                  @click="openDetail(p)"
                >
                  Detail
                </button>
                <div v-if="getCartQuantity(p) > 0" class="flex items-center gap-1">
                  <button @click="decreaseProduct(p)" class="px-2 py-1 bg-gray-100 rounded text-sm">âˆ’</button>
                  <span class="px-2 text-sm">{{ getCartQuantity(p) }}</span>
                  <button @click="addToCart(p)" class="px-2 py-1 bg-gray-100 rounded text-sm">+</button>
                </div>
                <button
                  v-else
                  class="text-xs bg-black text-white px-3 py-1 rounded"
                  @click="addToCart(p)"
                >
                  Add
                </button>
              </div>
            </div>
          </div>
        </template>
      </div>
    </div>
  </div>

  <!-- DETAIL PAGE -->
  <div v-if="page === 'detail' && selected">
    <button @click="page='list'" class="text-sm mb-3">â† Back</button>

    <div class="relative mb-3">
      <img :src="selected.image" class="w-full h-48 object-cover rounded">
      <img
        src="https://img.icons8.com/?size=48&id=6KiDYP2M5aXT&format=png"
        alt="Hot"
        class="absolute -top-2 -left-2 w-9 h-9"
        style="z-index:2"
      >
    </div>

    <h2 class="text-lg font-semibold mb-2">{{ selected.name }}</h2>
    <p class="text-xs text-gray-500 mb-1">Rp{{ selected.price.toLocaleString() }}</p>

    <div class="flex items-center gap-1 justify-end mb-4">
      <template v-if="getCartQuantity(selected) > 0">
        <button @click="decreaseProduct(selected)" class="px-2">âˆ’</button>
        <span class="px-1">{{ getCartQuantity(selected) }}</span>
        <button @click="addToCart(selected)" class="px-2">+</button>
      </template>
      <button
        v-else
        class="text-xs bg-black text-white px-2 py-1 rounded"
        @click="addToCart(selected)"
      >
        Add
      </button>
    </div>
    
    <p class="text-sm text-gray-600 mb-4">
      {{ selected.deskripsi }}
    </p>
  </div>

  <!-- CART PAGE -->
  <div v-if="page === 'cart'">
    <button @click="page='list'" class="text-sm mb-3">â† Back</button>

    <h2 class="font-semibold mb-2">Cart</h2>

    <table class="w-full text-sm bg-white rounded-lg overflow-hidden mb-4">
      <tr v-for="(item, i) in cart" :key="i" class="border-b">
        <td class="p-2">
          <img :src="item.product.image" class="w-14 h-14 object-cover rounded">
        </td>
        <td class="p-2">
          <p class="font-medium">{{ item.product.name }}</p>
          <p class="text-xs text-gray-500">Rp{{ item.product.price.toLocaleString() }}</p>
        </td>
        <td class="p-2 text-right">
          <div class="flex items-center gap-1 justify-end">
            <button @click="decreaseQuantity(i)" class="px-2">âˆ’</button>
            <span class="px-1">{{ item.quantity }}</span>
            <button @click="increaseQuantity(i)" class="px-2">+</button>
          </div>
        </td>
      </tr>
      <tr v-if="cart.length === 0">
        <td colspan="3" class="text-center p-4 text-gray-400">Cart is empty</td>
      </tr>
    </table>
    <div class="text-right font-semibold mb-2">
      Total: Rp{{ totalPrice.toLocaleString() }}
    </div>


    <button
      @click="sendWhatsapp"
      class="w-full bg-black text-green-600 py-2 rounded flex items-center justify-center gap-2"
      type="button"
    >
      <img src="https://img.icons8.com/?size=64&id=Fr3lHZpaL8k5&format=png" alt="WhatsApp" class="w-5 h-5">
      Order via WhatsApp
    </button>
  </div>

  <!-- NAVIGATION BAR -->
  <nav class="fixed bottom-0 left-0 right-0 bg-white border-t flex justify-around items-center py-2 z-10 max-w-md mx-auto">
    <button @click="page='list'" :class="navClass('list')" class="flex flex-col items-center text-xs">
      <img src="https://img.icons8.com/?size=64&id=PmSC86guKh6C&format=png" alt="List" class="w-6 h-6 mb-1">
      List
    </button>
    <button @click="page='cart'" :class="navClass('cart')" class="flex flex-col items-center text-xs">
      <img src="https://img.icons8.com/?size=64&id=y21Zo14Go4LV&format=png" alt="Cart" class="w-6 h-6 mb-1">
      Cart
    </button>
    <button @click="page='info'" :class="navClass('info')" class="flex flex-col items-center text-xs">
      <img src="https://img.icons8.com/?size=64&id=zyt9WZ3jEcGG&format=png" alt="Info" class="w-6 h-6 mb-1">
      Info
    </button>
  </nav>

  <!-- INFO JASTIP PAGE -->
  <div v-if="page === 'info'">
    <div class="bg-white rounded-lg p-4 mb-4">
    <h2 class="text-lg font-semibold mb-2">Info Jastip Tunisia</h2>
    <ul class="text-sm text-gray-700 list-disc pl-5 mb-2">
      <li>Jastip oleh Anah, tinggal di Tunisia ğŸ‡¹ğŸ‡³</li>
      <li>Produk asli Tunisia, dikirim ke Indonesia</li>
      <li>Order via WhatsApp, pembayaran transfer</li>
      <li>Estimasi pengiriman 2-4 minggu</li>
    </ul>
    <p class="text-xs text-gray-500 mb-1">Hubungi WhatsApp untuk pertanyaan lebih lanjut.</p>
    </div>
    <button
      @click="shareToWhatsapp"
      class="w-full bg-black text-green-600 py-2 rounded flex items-center justify-center gap-2"
      type="button"
    >
      <img src="https://img.icons8.com/?size=64&id=Fr3lHZpaL8k5&format=png" alt="WhatsApp" class="w-5 h-5">
      Share to WhatsApp
    </button>
  </div>

</div>

<script>
// https://icons8.com/icons/set/best-top--style-liquid-glass-color
const { createApp } = Vue

createApp({
  data() {
    return {
      page: 'list',
      selected: null,
      cart: [],
      products: [
        {
          id: 1,
          name: 'Pistachio asin bercangkang 100 g',
          image: 'https://www.carrefour.tn/media/catalog/product/2/8/2828991000000-1.webp?auto=webp&format=pjpg&width=2560&height=3200&fit=cover',
          deskripsi: 'Kue semolina isi kurma khas Tunisia.',
          price: 35000
        },
        {
          id: 2,
          name: 'Inti kenari kualitas ekstra 100 g',
          image: 'https://www.carrefour.tn/media/catalog/product/2/8/2824833000000.webp',
          deskripsi: 'Kue almond premium khas Tunisia.',
          price: 45000
        },
        {
          id: 3,
          name: 'Kacang almond 100 g',
          image: 'https://www.carrefour.tn/media/catalog/product/2/8/2828194000000.webp?auto=webp&format=pjpg&width=2560&height=3200&fit=cover',
          deskripsi: 'Saus cabai tradisional Tunisia.',
          price: 25000
        },
        // Ad product
        {
          id: 'ad-1',
          type: 'ad',
          image: 'https://dummyimage.com/202x320/eee/333&text=AD',
          title: 'Sponsored',
          link: 'https://www.example.com'
        }
      ]
    }
  },
  computed: {
    totalPrice() {
      return this.cart.reduce((sum, item) => sum + item.product.price * item.quantity, 0)
    }
  },
  methods: {
    openDetail(p) {
      this.selected = p
      this.page = 'detail'
    },
    addToCart(p) {
      const existing = this.cart.find(item => item.product.id === p.id)
      if (existing) {
        existing.quantity++
      } else {
        this.cart.push({ product: p, quantity: 1 })
      }
    },
    increaseQuantity(index) {
      this.cart[index].quantity++
    },
    decreaseQuantity(index) {
      if (this.cart[index].quantity > 1) {
        this.cart[index].quantity--
      } else {
        this.cart.splice(index, 1)
      }
    },
    sendWhatsapp() {
      if (this.cart.length === 0) return

      const text = this.cart
        .map((item, i) => `${i + 1}. ${item.product.name} x${item.quantity}`)
        .join('%0A')

      const phone = '6287772897512' // ganti nomor WA
      const url = `https://wa.me/${phone}?text=Order%20Jastip:%0A${text}`

      window.open(url, '_blank')
    },
    getCartQuantity(p) {
      const item = this.cart.find(item => item.product.id === p.id)
      return item ? item.quantity : 0
    },
    decreaseProduct(p) {
      const idx = this.cart.findIndex(item => item.product.id === p.id)
      if (idx !== -1) {
        if (this.cart[idx].quantity > 1) {
          this.cart[idx].quantity--
        } else {
          this.cart.splice(idx, 1)
        }
      }
    },
    navClass(pageName) {
      return this.page === pageName
        ? 'text-blue-600 font-semibold'
        : 'text-gray-500'
    },
    shareToWhatsapp() {
      const siteUrl = window.location.href;
      const preview = this.products
        .map(p => `â€¢ ${p.name}`)
        .join('%0A');
      const text =
        `Jastip Tunisia ğŸ‡¹ğŸ‡³%0A%0A` +
        `Available products:%0A${preview}%0A%0A` +
        `See more here ğŸ‘‡%0A${encodeURIComponent(siteUrl)}`;
      const url = `https://wa.me/?text=${text}`;
      window.open(url, '_blank');
    },
  }
}).mount('#app')
</script>
</body>
</html>
